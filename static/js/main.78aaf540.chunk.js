(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,r){e.exports=r(43)},42:function(e,t,r){},43:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(16),c=r.n(o),i=r(4),s=r(7),l=r(25),u=r(26),f=r(1);Object(s.d)({TrackballControls:u.a});var d=n.forwardRef(function(e,t){Object(l.a)(e);var r=n.useRef(),a=Object(s.g)(),o=a.camera,c=a.gl;return Object(s.f)(function(){r.current.update()}),n.useImperativeHandle(t,function(){return{resetCamera:function(){r.current.target.set(0,0,0),o.position.set(0,0,80),o.up.set(r.current.up0.x,r.current.up0.y,r.current.up0.z)}}}),n.createElement("trackballControls",{ref:r,args:[o,c.domElement],dynamicDampingFactor:.1,keys:[18,17,91],mouseButtons:{LEFT:f.MOUSE.PAN,MIDDLE:f.MOUSE.ZOOM,RIGHT:f.MOUSE.ROTATE}})}),m=r(22);var h=function(e){var t=e.data,r=e.layout,a=void 0===r?"grid":r;n.useEffect(function(){switch(a){case"spiral":!function(e){for(var t=0,r=0;r<e.length;++r){var n=e[r],a=Math.max(1,.8*Math.sqrt(r+1));t+=1*Math.asin(1/a),n.x=a*Math.cos(t),n.y=a*Math.sin(t),n.z=0}}(t);break;case"grid":default:!function(e){for(var t=e.length,r=Math.ceil(Math.sqrt(t)),n=r,a=0;a<t;++a){var o=e[a],c=a%r-r/2,i=Math.floor(a/r)-n/2;o.x=1.05*c,o.y=1.05*i,o.z=0}}(t)}},[t,a])};function g(e){var t=e.data,r=e.layout,a=e.onFrame;!function(e){var t=e.data,r=e.layout;n.useEffect(function(){for(var e=0;e<t.length;++e)t[e].sourceX=t[e].x||0,t[e].sourceY=t[e].y||0,t[e].sourceZ=t[e].z||0},[t,r]),h({data:t,layout:r}),n.useEffect(function(){for(var e=0;e<t.length;++e)t[e].targetX=t[e].x,t[e].targetY=t[e].y,t[e].targetZ=t[e].z},[t,r])}({data:t,layout:r});var o=n.useRef(r),c=Object(m.b)({animationProgress:1,from:{animationProgress:0},reset:r!==o.current,onFrame:function(e){var r=e.animationProgress;!function(e,t){for(var r=0;r<e.length;++r)e[r].x=(1-t)*e[r].sourceX+t*e[r].targetX,e[r].y=(1-t)*e[r].sourceY+t*e[r].targetY,e[r].z=(1-t)*e[r].sourceZ+t*e[r].targetZ}(t,r),a({animationProgress:r})}});return o.current=r,c}var v=new f.Object3D;function p(e){var t=e.mesh,r=e.data;if(t){for(var n=0;n<r.length;++n){var a=r[n],o=a.x,c=a.y,i=a.z;v.position.set(o,c,i),v.rotation.set(.5*Math.PI,0,0),v.updateMatrix(),t.setMatrixAt(n,v.matrix)}t.instanceMatrix.needsUpdate=!0}}var E=new f.Color,y=function(e){var t=e.data,r=e.layout,a=e.selectedPoint,o=e.onSelectPoint,c=n.useRef(),i=t.length,s=g({data:t,layout:r,onFrame:function(){p({mesh:c.current,data:t})}}).animationProgress;n.useEffect(function(){p({mesh:c.current,data:t})},[t,r]);var l=function(e){var t=e.data,r=e.selectedPoint,a=e.onSelectPoint,o=n.useRef([0,0]);return{handlePointerDown:function(e){o.current[0]=e.clientX,o.current[1]=e.clientY},handleClick:function(e){var n=e.instanceId,c=e.clientX,i=e.clientY;if(Math.sqrt(Math.pow(o.current[0]-c,2)+Math.pow(o.current[1]-i,2))>5)e.stopPropagation();else{var s=t[n];console.log("got point =",s),a(s===r?null:s)}}}}({data:t,selectedPoint:a,onSelectPoint:o}),u=l.handleClick,d=l.handlePointerDown,h=function(e){var t=e.data,r=e.selectedPoint,a=t.length,o=n.useRef(),c=n.useMemo(function(){return new Float32Array(3*a)},[a]);return n.useEffect(function(){for(var e=0;e<t.length;++e)E.set(t[e]===r?"#6f6":"#888"),E.toArray(c,3*e);o.current.needsUpdate=!0},[t,r,c]),{colorAttrib:o,colorArray:c}}({data:t,selectedPoint:a}),v=h.colorAttrib,y=h.colorArray;return n.createElement(n.Fragment,null,n.createElement("instancedMesh",{ref:c,args:[null,null,i],frustumCulled:!1,onClick:u,onPointerDown:d},n.createElement("cylinderBufferGeometry",{attach:"geometry",args:[.5,.5,.15,32]},n.createElement("instancedBufferAttribute",{ref:v,attachObject:["attributes","color"],args:[y,3]})),n.createElement("meshStandardMaterial",{attach:"material",vertexColors:f.VertexColors})),a&&n.createElement(m.a.group,{position:s.interpolate(function(){return[a.x,a.y,a.z]})},n.createElement("pointLight",{distance:9,position:[0,0,.3],intensity:2.2,decay:30,color:"#3f3"}),n.createElement("pointLight",{position:[0,0,0],decay:1,distance:5,intensity:1.5,color:"#2f0"})))},b=r(33),P=r(17),M=r(31),w=r(34),C=r(32);function O(){var e=Object(n.useRef)(),t=Object(s.g)(),r=t.scene,o=t.gl,c=t.size,i=t.camera,l=Object(n.useMemo)(function(){return new f.Vector2(c.width,c.height)},[c]);Object(n.useEffect)(function(){e.current.setSize(c.width,c.height)},[c]),Object(s.f)(function(){return e.current.render()},1);var u={resolution:l,strength:.6,radius:.01,threshold:.4};return a.a.createElement("effectComposer",{ref:e,args:[o]},a.a.createElement("renderPass",{attachArray:"passes",scene:r,camera:i}),a.a.createElement("unrealBloomPass",{attachArray:"passes",args:[u.resolution,u.strength,u.radius,u.threshold]}),a.a.createElement("shaderPass",{attachArray:"passes",args:[C.a],"material-uniforms-resolution-value":[1/c.width,1/c.height],renderToScreen:!0}))}Object(s.d)({EffectComposer:b.a,ShaderPass:P.a,RenderPass:M.a,UnrealBloomPass:w.a});var x=n.forwardRef(function(e,t){var r=e.data,a=e.layout,o=e.selectedPoint,c=e.onSelectPoint,i=n.useRef();return n.useImperativeHandle(t,function(){return{resetCamera:function(){return i.current.resetCamera()}}}),n.createElement(s.a,{camera:{position:[0,0,80],far:15e3}},n.createElement(d,{ref:i}),n.createElement("ambientLight",{color:"#ffffff",intensity:.1}),n.createElement("hemisphereLight",{color:"#ffffff",skyColor:"#ffffbb",groundColor:"#080820",intensity:1}),n.createElement(y,{data:r,layout:a,selectedPoint:o,onSelectPoint:c}),n.createElement(O,null))}),S=(r(42),new Array(1e4).fill(0).map(function(e,t){return{id:t}}));var j=document.getElementById("root");c.a.render(a.a.createElement(function(){var e=n.useState("grid"),t=Object(i.a)(e,2),r=t[0],a=t[1],o=n.useState(null),c=Object(i.a)(o,2),s=c[0],l=c[1],u=n.useRef();return n.createElement("div",{className:"App"},n.createElement("div",{className:"vis-container"},n.createElement(x,{ref:u,data:S,layout:r,selectedPoint:s,onSelectPoint:l})),n.createElement("button",{className:"reset-button",onClick:function(){u.current.resetCamera()}},"Reset Camera"),n.createElement("div",{className:"controls"},n.createElement("strong",null,"Layouts")," ",n.createElement("button",{onClick:function(){return a("grid")},className:"grid"===r?"active":void 0},"Grid"),n.createElement("button",{onClick:function(){return a("spiral")},className:"spiral"===r?"active":void 0},"Spiral"),s&&n.createElement("div",{className:"selected-point"},"You selected ",n.createElement("strong",null,s.id))))},null),j)}},[[35,1,2]]]);
//# sourceMappingURL=main.78aaf540.chunk.js.map